- content_for :primary_nav do
  =render :partial => 'admin/shared/navbar'

#content
  %h1 Order ##{@order.id}
  .box
    %p
      %b Placed by:
      = @order.customer.full_name rescue ""
    %p
      %b Date Created:
      = @order.created_at
    %p
      %b Product(s) requested:
    %table.table
      %tr
        %th.first
        %th Title
        %th Media
        %th Quantity
        %th Price
        %th.last
      - for item in @order.items
        %tr{:class => cycle("odd", "even")}
          %td
          %td
            %strong= item.product.title
            %br by #{link_to item.product.publisher.full_name, admin_publisher_path(item.product.publisher)} Publisher
            %br with
            %em= item.packaging_option.title
          %td= item.product.media_type.name
          %td= item.quantity
          %td
            = number_to_currency(item.product.price * item.quantity)
            %br
            = number_to_currency(item.packaging_option.price * item.quantity)
          %td
      %tr
        %th.first
        %th{:colspan => 2}
        %th SubTotal
        %th= number_to_currency(@order.subtotal)
        %th.last
      %tr
        %td.first
        %td{:colspan => 2}
        %td
          Shipping Option Selected
          %em= @order.shipping_option.title
        %td= number_to_currency(@order.shipping_option.price)
        %td.last
      %tr
        %th.first
        %th{:colspan => 2}
        %th 
          %strong Total
        %th= number_to_currency(@order.total)
        %th.last
    %p
      %b Billing Address:
      %br= @order.billing_address
    %p
      %b Shipping Address:
      %br= @order.shipping_address

  %h1 FirstData transactions logging
  .box
    %table.table
      %tr
        %th.first
        %th Date
        %th Action
        %th Successful?
        %th Response
      - for transaction in @order.transactions
        %tr{:class => cycle("odd", "even")}
          %td
          %td{:valign => 'top'}= transaction.created_at
          %td{:valign => 'top'}= transaction.action
          %td{:valign => 'top'}= transaction.success ? 'Yes!' : 'No'
          %td
            %table
              %tr
                %td CSP:
                %td= transaction.params['csp']
              %tr
                %td Code:
                %td= transaction.params['code']
              %tr
                %td TDate:
                %td= transaction.params['tdate']
              %tr
                %td Time:
                %td= transaction.params['time']
              %tr
                %td OrderNum:
                %td= transaction.params['ordernum']
              %tr
                %td Approved:
                %td= transaction.params['approved']
              %tr
                %td Complete:
                %td= transaction.params['complete']
              %tr
                %td AVS:
                %td= transaction.params['avs']
              %tr
                %td Ref:
                %td= transaction.params['ref']
              %tr
                %td Score:
                %td= transaction.params['score']
              %tr
                %td Message:
                %td= transaction.params['message']
              %tr
                %td AuthResponse:
                %td= transaction.params['authresponse']
              %tr
                %td Error:
                %td= transaction.params['error']

- content_for :sidebar, render(:partial => 'admin/shared/sidebar')

